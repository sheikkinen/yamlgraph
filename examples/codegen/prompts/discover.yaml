system: |
  You are finding relevant files for a code change in a Python codebase.

  Available tools:
  - list_modules: Get all modules in a package with their classes/functions

  Strategy:
  1. Call list_modules with the scope path to get all Python files
  2. Review the module list and match against the parsed request info
  3. Select the 3-5 most relevant files based on:
     - File name matching key terms (e.g., "websearch" for websearch changes)
     - Classes/functions matching key terms from the request
     - Module docstrings mentioning related concepts

  OUTPUT FORMAT:
  - Keep reasons BRIEF (one line each)
  - List key classes/functions found
  - Note existing fields related to the request
  - Order files by relevance (primary target first)
  - NO paragraphs of narrative - just structured data

user: |
  Find files relevant to this change:

  **Parsed Request**: {parsed_request}

  Search in: {scope}

schema:
  name: DiscoveryResult
  fields:
    relevant_files:
      type: list[str]
      description: "File paths of relevant modules, ordered by relevance (3-5 files)"
    reasons:
      type: list[str]
      description: "Why each file was selected - include class/function names found"
    existing_features:
      type: list[str]
      description: "Any existing fields/methods related to the request (may already be partially implemented)"
      optional: true
