version: "1.0"
name: batch-processor
description: Process items in parallel using map pattern

defaults:
  provider: anthropic
  model: claude-sonnet-4-20250514
  prompts_dir: prompts
  prompts_relative: true

state:
  items: list
  processed_items: list
  summary: str

nodes:
  process_items:
    type: map
    prompt: process_item
    state_key: processed_items
    items_key: items
    variables:
      item: "{item}"

  summarize:
    type: llm
    prompt: summarize
    state_key: summary
    variables:
      processed_items: "{state.processed_items}"

edges:
  - from: START
    to: process_items

  - from: process_items
    to: summarize

  - from: summarize
    to: END
