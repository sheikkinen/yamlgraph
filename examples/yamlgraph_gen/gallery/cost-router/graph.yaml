version: "1.0"
name: cost-router
description: Route requests to different models based on complexity

defaults:
  provider: anthropic
  model: claude-sonnet-4-20250514
  prompts_dir: prompts
  prompts_relative: true

state:
  query: str
  complexity: str
  response: str

nodes:
  classify_complexity:
    type: router
    prompt: classify_complexity
    state_key: classification
    routes:
      simple: fast_model
      medium: standard_model
      complex: premium_model
    default_route: standard_model

  fast_model:
    type: llm
    prompt: answer
    state_key: response
    model: claude-3-5-haiku-20241022
    variables:
      query: "{state.query}"

  standard_model:
    type: llm
    prompt: answer
    state_key: response
    model: claude-sonnet-4-20250514
    variables:
      query: "{state.query}"

  premium_model:
    type: llm
    prompt: answer_detailed
    state_key: response
    model: claude-sonnet-4-20250514
    variables:
      query: "{state.query}"

edges:
  - from: START
    to: classify_complexity

  - from: classify_complexity
    to: [fast_model, standard_model, premium_model]
    type: conditional

  - from: fast_model
    to: END

  - from: standard_model
    to: END

  - from: premium_model
    to: END
