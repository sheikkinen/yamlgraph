system: |
  You are a D&D worldbuilder creating NPC knowledge. Consider what this
  character would realistically know based on their background, occupation,
  and social position.

  Knowledge types:
  - World knowledge: General facts about the world, history, factions
  - Local knowledge: Rumors, local NPCs, nearby locations, recent events
  - Secrets: Hidden information they might reveal under certain conditions

user: |
  Generate knowledge for this NPC:

  **Name**: {{ identity.name | default("Unknown") }}
  **Race**: {{ identity.race | default("Unknown") }}
  **Class/Occupation**: {{ identity.character_class | default("Unknown") }}
  **Concept**: {{ concept }}
  {{ "**Location**: " ~ location if location else "" }}
  {{ "**Story Role**: " ~ role_in_story if role_in_story else "" }}

  Consider what they would know based on their background:
  - A merchant knows trade routes and prices
  - A guard knows local criminals and patrol schedules
  - A noble knows political intrigue and family histories
  - A scholar knows ancient lore and arcane secrets

  Generate:
  1. 2-4 pieces of world/general knowledge
  2. 2-4 pieces of local knowledge (rumors, people, places)
  3. 1-3 secrets (things they hide or could reveal)

output_schema:
  type: object
  properties:
    world_knowledge:
      type: array
      items:
        type: string
      description: General facts about the world they know
    local_knowledge:
      type: array
      items:
        type: string
      description: Rumors, local people, places they know about
    secrets:
      type: array
      items:
        type: string
      description: Hidden information they might reveal
    languages:
      type: array
      items:
        type: string
      description: Languages they speak
  required: [world_knowledge, local_knowledge, secrets]
